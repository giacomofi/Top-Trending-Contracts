['pragma solidity ^0.4.19;\n', '\n', 'contract Ranking {\n', '    event CreateEvent(uint id, uint bid, string name, string link);\n', '    event SupportEvent(uint id, uint bid);\n', '    \n', '    struct Record {\n', '        uint bid;\n', '        string name;\n', '        string link;\n', '    }\n', '\n', '    address public owner;\n', '    Record[] public records;\n', '\n', '    function Ranking() public {\n', '        owner = msg.sender;\n', '    }\n', '\n', '    modifier onlyOwner() {\n', '        require(msg.sender == owner);\n', '        _;\n', '    }\n', '\n', '    function withdraw() external onlyOwner {\n', '        owner.transfer(address(this).balance);\n', '    }\n', '\n', '    function updateRecordName(uint _id, string _name) external onlyOwner {\n', '        require(_utfStringLength(_name) <= 20);\n', '        require(_id < records.length);\n', '        records[_id].name = _name;\n', '    }\n', '\n', '    function createRecord (string _name, string _link) external payable {\n', '        require(msg.value >= 0.001 ether);\n', '        require(_utfStringLength(_name) <= 20);\n', '        require(_utfStringLength(_link) <= 50);\n', '        uint id = records.push(Record(msg.value, _name, _link)) - 1;\n', '        CreateEvent(id, msg.value, _name, _link);\n', '    }\n', '\n', '    function supportRecord(uint _id) external payable {\n', '        require(msg.value >= 0.001 ether);\n', '        require(_id < records.length);\n', '        records[_id].bid += msg.value;\n', '        SupportEvent (_id, records[_id].bid);\n', '    }\n', '\n', '    function listRecords () external view returns (uint[2][]) {\n', '        uint[2][] memory result = new uint[2][](records.length);\n', '        for (uint i = 0; i < records.length; i++) {\n', '            result[i][0] = i;\n', '            result[i][1] = records[i].bid;\n', '        }\n', '        return result;\n', '    }\n', '    \n', '    function getRecordCount() external view returns (uint) {\n', '        return records.length;\n', '    }\n', '\n', '    function _utfStringLength(string str) private pure returns (uint) {\n', '        uint i = 0;\n', '        uint l = 0;\n', '        bytes memory string_rep = bytes(str);\n', '\n', '        while (i<string_rep.length) {\n', '            if (string_rep[i]>>7==0)\n', '                i += 1;\n', '            else if (string_rep[i]>>5==0x6)\n', '                i += 2;\n', '            else if (string_rep[i]>>4==0xE)\n', '                i += 3;\n', '            else if (string_rep[i]>>3==0x1E)\n', '                i += 4;\n', '            else\n', '                //For safety\n', '                i += 1;\n', '\n', '            l++;\n', '        }\n', '\n', '        return l;\n', '    }\n', '}']
['pragma solidity ^0.4.19;\n', '\n', 'contract Ranking {\n', '    event CreateEvent(uint id, uint bid, string name, string link);\n', '    event SupportEvent(uint id, uint bid);\n', '    \n', '    struct Record {\n', '        uint bid;\n', '        string name;\n', '        string link;\n', '    }\n', '\n', '    address public owner;\n', '    Record[] public records;\n', '\n', '    function Ranking() public {\n', '        owner = msg.sender;\n', '    }\n', '\n', '    modifier onlyOwner() {\n', '        require(msg.sender == owner);\n', '        _;\n', '    }\n', '\n', '    function withdraw() external onlyOwner {\n', '        owner.transfer(address(this).balance);\n', '    }\n', '\n', '    function updateRecordName(uint _id, string _name) external onlyOwner {\n', '        require(_utfStringLength(_name) <= 20);\n', '        require(_id < records.length);\n', '        records[_id].name = _name;\n', '    }\n', '\n', '    function createRecord (string _name, string _link) external payable {\n', '        require(msg.value >= 0.001 ether);\n', '        require(_utfStringLength(_name) <= 20);\n', '        require(_utfStringLength(_link) <= 50);\n', '        uint id = records.push(Record(msg.value, _name, _link)) - 1;\n', '        CreateEvent(id, msg.value, _name, _link);\n', '    }\n', '\n', '    function supportRecord(uint _id) external payable {\n', '        require(msg.value >= 0.001 ether);\n', '        require(_id < records.length);\n', '        records[_id].bid += msg.value;\n', '        SupportEvent (_id, records[_id].bid);\n', '    }\n', '\n', '    function listRecords () external view returns (uint[2][]) {\n', '        uint[2][] memory result = new uint[2][](records.length);\n', '        for (uint i = 0; i < records.length; i++) {\n', '            result[i][0] = i;\n', '            result[i][1] = records[i].bid;\n', '        }\n', '        return result;\n', '    }\n', '    \n', '    function getRecordCount() external view returns (uint) {\n', '        return records.length;\n', '    }\n', '\n', '    function _utfStringLength(string str) private pure returns (uint) {\n', '        uint i = 0;\n', '        uint l = 0;\n', '        bytes memory string_rep = bytes(str);\n', '\n', '        while (i<string_rep.length) {\n', '            if (string_rep[i]>>7==0)\n', '                i += 1;\n', '            else if (string_rep[i]>>5==0x6)\n', '                i += 2;\n', '            else if (string_rep[i]>>4==0xE)\n', '                i += 3;\n', '            else if (string_rep[i]>>3==0x1E)\n', '                i += 4;\n', '            else\n', '                //For safety\n', '                i += 1;\n', '\n', '            l++;\n', '        }\n', '\n', '        return l;\n', '    }\n', '}']
