['pragma solidity ^0.4.15;\n', '\n', 'contract AffiliateNetwork {\n', '    uint public idx = 0;\n', '    mapping (uint => address) public affiliateAddresses;\n', '    mapping (address => uint) public affiliateCodes;\n', '\n', '    function () payable {\n', '        if (msg.value > 0) {\n', '            msg.sender.transfer(msg.value);\n', '        }\n', '\n', '        addAffiliate();\n', '    }\n', '\n', '    function addAffiliate() {\n', '        if (affiliateCodes[msg.sender] != 0) { return; }\n', '\n', '        idx += 1;   // first assigned code will be 1\n', '        affiliateAddresses[idx] = msg.sender;\n', '        affiliateCodes[msg.sender] = idx;\n', '    }\n', '}']