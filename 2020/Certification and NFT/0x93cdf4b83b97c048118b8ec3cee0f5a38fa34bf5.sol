['/* Update:\n', ' * Wallet added to Deploy Procedure\n', ' */\n', '/* Discussion:\n', ' * https://gitcoin.co/grants/154/decentralized-flexible-organization\n', ' */\n', '/* Description:\n', ' * DFOHub - Proposal Manager Creation.\n', ' * This specific DFOHub functionality is called during the new DFO creation procedure.\n', ' * It just initializes a new Proposal Manager, cloning the logic from the original DFOHub one.\n', ' * This is a solo-Functionality made as a workaround of the cumulative gas consumption problem.\n', ' */\n', '/* Update: \n', ' * Introducing DoubleProxy to let external Constracts always locate the DFO proxy\n', ' */\n', 'pragma solidity ^0.6.0;\n', '\n', 'contract DeployProposalsManager {\n', '\n', '    function onStart(address, address) public {\n', '    }\n', '\n', '    function onStop(address) public {\n', '    }\n', '\n', '    function deployProposalsManager(address sender, uint256) public returns (address mvdFunctionalityProposalManagerAddress, address mvdWallet, address doubleProxy) {\n', '        IMVDProxy senderProxy = IMVDProxy(msg.sender);\n', '        senderProxy\n', '            .emitEvent("DFOCollateralContractsCloned(address_indexed,address,address,address)", abi.encodePacked(sender), bytes(""),\n', '            abi.encode(\n', '                mvdFunctionalityProposalManagerAddress = clone(senderProxy.getMVDFunctionalityProposalManagerAddress()),\n', '                mvdWallet = clone(senderProxy.getMVDWalletAddress()),\n', '                doubleProxy = clone(senderProxy.getDoubleProxyAddress())\n', '            )\n', '        );\n', '    }\n', '\n', '    function clone(address original) private returns(address copy) {\n', '        assembly {\n', '            mstore(0, or(0x5880730000000000000000000000000000000000000000803b80938091923cF3, mul(original, 0x1000000000000000000)))\n', '            copy := create(0, 0, 32)\n', '            switch extcodesize(copy) case 0 { invalid() }\n', '        }\n', '    }\n', '}\n', '\n', 'interface IMVDProxy {\n', '    function getMVDFunctionalityProposalManagerAddress() external view returns(address);\n', '    function getMVDWalletAddress() external view returns(address);\n', '    function getDoubleProxyAddress() external view returns(address);\n', '    function emitEvent(string calldata eventSignature, bytes calldata firstIndex, bytes calldata secondIndex, bytes calldata data) external;\n', '}']