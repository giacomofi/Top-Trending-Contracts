['/**\n', ' *Submitted for verification at Etherscan.io on 2021-05-12\n', '*/\n', '\n', '//      https://github.com/austintgriffith/scaffold-eth/tree/simple-stream\n', '\n', '// File contracts/SimpleStream.sol\n', '\n', 'pragma solidity >=0.8.0;\n', '//SPDX-License-Identifier: MIT\n', '\n', '//import "hardhat/console.sol";\n', '\n', 'contract SimpleStream {\n', '\n', '  event Withdraw( address indexed to, uint256 amount, string reason );\n', '  event Deposit( address indexed from, uint256 amount, string reason );\n', '\n', '  address payable public toAddress;// = payable(0xD75b0609ed51307E13bae0F9394b5f63A7f8b6A1);\n', '  uint256 public cap;// = 0.5 ether;\n', '  uint256 public frequency;// 1296000 seconds == 2 weeks;\n', '  uint256 public last;//stream starts empty (last = block.timestamp) or full (block.timestamp - frequency)\n', '\n', '  constructor(address payable _toAddress, uint256 _cap, uint256 _frequency, bool _startsFull) public {\n', '    toAddress = _toAddress;\n', '    cap = _cap;\n', '    frequency = _frequency;\n', '    if(_startsFull){\n', '      last = block.timestamp - frequency;\n', '    }else{\n', '      last = block.timestamp;\n', '    }\n', '  }\n', '\n', '  function streamBalance() public view returns (uint256){\n', '    if(block.timestamp-last > frequency){\n', '      return cap;\n', '    }\n', '    return (cap * (block.timestamp-last)) / frequency;\n', '  }\n', '\n', '  function streamWithdraw(uint256 amount, string memory reason) public {\n', '       require(msg.sender==toAddress,"this stream is not for you");\n', '       uint256 totalAmountCanWithdraw = streamBalance();\n', '       require(totalAmountCanWithdraw>=amount,"not enough in the stream");\n', '       uint256 cappedLast = block.timestamp-frequency;\n', '       if(last<cappedLast){\n', '         last = cappedLast;\n', '       }\n', '       last = last + ((block.timestamp - last) * amount / totalAmountCanWithdraw);\n', '       emit Withdraw( msg.sender, amount, reason );\n', '       toAddress.transfer(amount);\n', '   }\n', '\n', '   function streamDeposit(string memory reason) public payable {\n', '      require(msg.value>=cap/10,"Not big enough, sorry.");\n', '      emit Deposit( msg.sender, msg.value, reason );\n', '    }\n', '\n', '   receive() external payable { streamDeposit(""); }\n', '}']