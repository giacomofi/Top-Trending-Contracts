['/**\n', ' *Submitted for verification at Etherscan.io on 2021-02-18\n', '*/\n', '\n', '// File: contracts\\fixed-inflation\\util\\DFOHub.sol\n', '\n', '// SPDX-License-Identifier: MIT\n', '\n', 'pragma solidity ^0.7.6;\n', '\n', 'interface IDoubleProxy {\n', '    function proxy() external view returns (address);\n', '}\n', '\n', 'interface IMVDProxy {\n', '    function getMVDFunctionalitiesManagerAddress() external view returns(address);\n', '    function getMVDWalletAddress() external view returns (address);\n', '    function getStateHolderAddress() external view returns(address);\n', '    function submit(string calldata codeName, bytes calldata data) external payable returns(bytes memory returnData);\n', '}\n', '\n', 'interface IMVDFunctionalitiesManager {\n', '    function getFunctionalityData(string calldata codeName) external view returns(address, uint256, string memory, address, uint256);\n', '    function isAuthorizedFunctionality(address functionality) external view returns(bool);\n', '}\n', '\n', 'interface IStateHolder {\n', '    function getUint256(string calldata name) external view returns(uint256);\n', '    function getAddress(string calldata name) external view returns(address);\n', '    function clear(string calldata varName) external returns(string memory oldDataType, bytes memory oldVal);\n', '}\n', '\n', '// File: contracts\\fixed-inflation\\IFixedInflationFactory.sol\n', '\n', '//SPDX_License_Identifier: MIT\n', 'pragma solidity ^0.7.6;\n', '\n', 'interface IFixedInflationFactory {\n', '\n', '    event ExtensionCloned(address indexed);\n', '\n', '    function fixedInflationDefaultExtension() external view returns (address);\n', '\n', '    function feePercentageInfo() external view returns (uint256, address);\n', '\n', '    function cloneFixedInflationDefaultExtension() external returns(address clonedExtension);\n', '}\n', '\n', '// File: contracts\\fixed-inflation\\FixedInflationFactory.sol\n', '\n', '//SPDX_License_Identifier: MIT\n', 'pragma solidity ^0.7.6;\n', '\n', '\n', '\n', 'contract FixedInflationFactory is IFixedInflationFactory {\n', '\n', '    // fixed inflation contract implementation address\n', '    address public fixedInflationImplementationAddress;\n', '\n', '    // fixed inflation default extension\n', '    address public override fixedInflationDefaultExtension;\n', '\n', '    // double proxy address of the linked DFO\n', '    address public _doubleProxy;\n', '\n', '    // linked DFO exit fee\n', '    uint256 private _feePercentage;\n', '\n', '    // event that tracks fixed inflation contracts deployed\n', '    event FixedInflationDeployed(address indexed fixedInflationAddress, address indexed sender, bytes fixedInflationInitResultData);\n', '\n', '    // event that tracks logic contract address change\n', '    event FixedInflationLogicSet(address indexed newAddress);\n', '\n', '    // event that tracks default extension contract address change\n', '    event FixedInflationDefaultExtensionSet(address indexed newAddress);\n', '\n', '    // event that tracks wallet changes\n', '    event FeePercentageSet(uint256 newFeePercentage);\n', '\n', '    constructor(address doubleProxy, address _fixedInflationImplementationAddress, address _fixedInflationDefaultExtension, uint256 feePercentage) {\n', '        _doubleProxy = doubleProxy;\n', '        emit FixedInflationLogicSet(fixedInflationImplementationAddress = _fixedInflationImplementationAddress);\n', '        emit FixedInflationDefaultExtensionSet(fixedInflationDefaultExtension = _fixedInflationDefaultExtension);\n', '        emit FeePercentageSet(_feePercentage = feePercentage);\n', '    }\n', '\n', '    /** PUBLIC METHODS */\n', '\n', '    function feePercentageInfo() public override view returns (uint256, address) {\n', '        return (_feePercentage, IMVDProxy(IDoubleProxy(_doubleProxy).proxy()).getMVDWalletAddress());\n', '    }\n', '\n', '    /** @dev allows the DFO to update the double proxy address.\n', '      * @param newDoubleProxy new double proxy address.\n', '    */\n', '    function setDoubleProxy(address newDoubleProxy) public onlyDFO {\n', '        _doubleProxy = newDoubleProxy;\n', '    }\n', '\n', '    /** @dev change the fee percentage\n', '     * @param feePercentage new fee percentage.\n', '     */\n', '    function updateFeePercentage(uint256 feePercentage) public onlyDFO {\n', '        emit FeePercentageSet(_feePercentage = feePercentage);\n', '    }\n', '\n', '    /** @dev allows the factory owner to update the logic contract address.\n', '     * @param _fixedInflationImplementationAddress new fixed inflation implementation address.\n', '     */\n', '    function updateLogicAddress(address _fixedInflationImplementationAddress) public onlyDFO {\n', '        emit FixedInflationLogicSet(fixedInflationImplementationAddress = _fixedInflationImplementationAddress);\n', '    }\n', '\n', '    /** @dev allows the factory owner to update the extension contract address.\n', '     * @param _fixedInflationDefaultExtension new fixed inflation extension address.\n', '     */\n', '    function updateDefaultExtensionAddress(address _fixedInflationDefaultExtension) public onlyDFO {\n', '        emit FixedInflationDefaultExtensionSet(fixedInflationDefaultExtension = _fixedInflationDefaultExtension);\n', '    }\n', '\n', '    function cloneFixedInflationDefaultExtension() public override returns(address clonedExtension) {\n', '        emit ExtensionCloned(clonedExtension = _clone(fixedInflationDefaultExtension));\n', '    }\n', '\n', '    /** @dev this function deploys a new FixedInflation contract and calls the encoded function passed as data.\n', '     * @param data encoded initialize function for the fixed inflation contract (check FixedInflation contract code).\n', '     * @return contractAddress new fixed inflation contract address.\n', '     * @return initResultData new fixed inflation contract call result.\n', '     */\n', '    function deploy(bytes memory data) public returns (address contractAddress, bytes memory initResultData) {\n', '        initResultData = _call(contractAddress = _clone(fixedInflationImplementationAddress), data);\n', '        emit FixedInflationDeployed(contractAddress, msg.sender, initResultData);\n', '    }\n', '\n', '    /** PRIVATE METHODS */\n', '\n', '    /** @dev clones the input contract address and returns the copied contract address.\n', '     * @param original address of the original contract.\n', '     * @return copy copied contract address.\n', '     */\n', '    function _clone(address original) private returns (address copy) {\n', '        assembly {\n', '            mstore(\n', '                0,\n', '                or(\n', '                    0x5880730000000000000000000000000000000000000000803b80938091923cF3,\n', '                    mul(original, 0x1000000000000000000)\n', '                )\n', '            )\n', '            copy := create(0, 0, 32)\n', '            switch extcodesize(copy)\n', '                case 0 {\n', '                    invalid()\n', '                }\n', '        }\n', '    }\n', '\n', '    function _call(address location, bytes memory payload) private returns(bytes memory returnData) {\n', '        assembly {\n', '            let result := call(gas(), location, 0, add(payload, 0x20), mload(payload), 0, 0)\n', '            let size := returndatasize()\n', '            returnData := mload(0x40)\n', '            mstore(returnData, size)\n', '            let returnDataPayloadStart := add(returnData, 0x20)\n', '            returndatacopy(returnDataPayloadStart, 0, size)\n', '            mstore(0x40, add(returnDataPayloadStart, size))\n', '            switch result case 0 {revert(returnDataPayloadStart, size)}\n', '        }\n', '    }\n', '\n', '    /** @dev onlyDFO modifier used to check for unauthorized accesses. */\n', '    modifier onlyDFO() {\n', '        require(IMVDFunctionalitiesManager(IMVDProxy(IDoubleProxy(_doubleProxy).proxy()).getMVDFunctionalitiesManagerAddress()).isAuthorizedFunctionality(msg.sender), "Unauthorized.");\n', '        _;\n', '    }\n', '}']